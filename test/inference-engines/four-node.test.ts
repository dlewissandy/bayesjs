import { network } from '../../models/fourNode'
import { runTests } from './helpers'

// These gold standard values were computed indepdendently in R.
const GOLD_STANDARD: [string[], number][] = [
  [['T', '-0.5', '-1', 'A'], 2.95043178515236E-03],
  [['F', '-0.5', '-1', 'A'], 1.56461307287753E-02],
  [['T', '0', '-1', 'A'], 3.47109621782630E-04],
  [['F', '0', '-1', 'A'], 3.12922614575506E-02],
  [['T', '0.5', '-1', 'A'], 1.40815261893609E-04],
  [['F', '0.5', '-1', 'A'], 5.50100605171548E-03],
  [['T', '-0.5', '0', 'A'], 4.08364260920741E-05],
  [['F', '-0.5', '0', 'A'], 3.68144252441771E-03],
  [['T', '0', '0', 'A'], 2.40214271129848E-06],
  [['F', '0', '0', 'A'], 3.68144252441771E-03],
  [['T', '0.5', '0', 'A'], 2.04182130460370E-04],
  [['F', '0.5', '0', 'A'], 1.35599799649386E-01],
  [['T', '-0.5', '1', 'A'], 1.02091065230185E-04],
  [['F', '-0.5', '1', 'A'], 3.98822940145253E-03],
  [['T', '0', '1', 'A'], 2.40214271129847E-05],
  [['F', '0', '1', 'A'], 1.59529176058101E-02],
  [['T', '0.5', '1', 'A'], 6.00535677824618E-05],
  [['F', '0.5', '1', 'A'], 1.72823274062943E-02],
  [['T', '-0.5', '-1', 'B'], 3.47109621782630E-04],
  [['F', '-0.5', '-1', 'B'], 1.84072126220885E-03],
  [['T', '0', '-1', 'B'], 2.04182130460370E-05],
  [['F', '0', '-1', 'B'], 1.84072126220885E-03],
  [['T', '0.5', '-1', 'B'], 1.19692972915841E-03],
  [['F', '0.5', '-1', 'B'], 4.67585515592285E-02],
  [['T', '-0.5', '0', 'B'], 2.04182130460371E-05],
  [['F', '-0.5', '0', 'B'], 1.84072126220885E-03],
  [['T', '0', '0', 'B'], 4.80428542259695E-06],
  [['F', '0', '0', 'B'], 7.36288504883542E-03],
  [['T', '0.5', '0', 'B'], 1.20107135564924E-05],
  [['F', '0.5', '0', 'B'], 7.97645880290505E-03],
  [['T', '-0.5', '1', 'B'], 1.73554810891315E-03],
  [['F', '-0.5', '1', 'B'], 6.77998998246929E-02],
  [['T', '0', '1', 'B'], 2.04182130460370E-04],
  [['F', '0', '1', 'B'], 1.35599799649386E-01],
  [['T', '0.5', '1', 'B'], 1.20107135564924E-04],
  [['F', '0.5', '1', 'B'], 3.45646548125886E-02],
  [['T', '-0.5', '-1', 'C'], 1.73554810891315E-04],
  [['F', '-0.5', '-1', 'C'], 9.20360631104426E-04],
  [['T', '0', '-1', 'C'], 4.08364260920741E-05],
  [['F', '0', '-1', 'C'], 3.68144252441771E-03],
  [['T', '0.5', '-1', 'C'], 7.04076311509866E-04],
  [['F', '0.5', '-1', 'C'], 2.75050303383420E-02],
  [['T', '-0.5', '0', 'C'], 3.47109621782630E-04],
  [['F', '-0.5', '0', 'C'], 3.12922614575506E-02],
  [['T', '0', '0', 'C'], 4.08364260920741E-05],
  [['F', '0', '0', 'C'], 6.25845229151011E-02],
  [['T', '0.5', '0', 'C'], 2.40214271129847E-05],
  [['F', '0.5', '0', 'C'], 1.59529176058101E-02],
  [['T', '-0.5', '1', 'C'], 2.04182130460370E-04],
  [['F', '-0.5', '1', 'C'], 7.97645880290505E-03],
  [['T', '0', '1', 'C'], 1.20107135564924E-05],
  [['F', '0', '1', 'C'], 7.97645880290505E-03],
  [['T', '0.5', '1', 'C'], 1.02091065230185E-03],
  [['F', '0.5', '1', 'C'], 2.93799565907003E-01],
]

const names: string[] = ['B', 'F', 'I', 'S']
const testValues: string[][][] = [
  [['T'], ['F'], ['T', 'F']],
  [['-0.5'], ['0'], ['0.5'], ['-0.5', '0']],
  [['-1'], ['0'], ['1'], ['0', '1']],
  [['A'], ['B'], ['C'], ['A', 'C']],
]

describe('inference on 4 node network', () => runTests(network, names, testValues, GOLD_STANDARD))
